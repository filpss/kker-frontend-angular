<mat-card appearance="outlined">
    <mat-card-header>
        <mat-card-title>
          {{isEditMode ? 'Editar Venda' : 'Cadastrar Venda'}}
        </mat-card-title>
    </mat-card-header>

    <mat-card-content>
      <form [formGroup]="vendaForm" (ngSubmit)="onSubmit()">
        <mat-grid-list cols="4" rowHeight="100px" gutterSize="8px">

          <mat-grid-tile>

            <mat-form-field>
              <mat-label>Cliente</mat-label>
              <mat-select required formControlName="cliente">
                @for (cliente of clientes; track cliente) {
                  <mat-option [value]="cliente.id">{{cliente.nome}}</mat-option>
                }
              </mat-select>
            </mat-form-field>

          </mat-grid-tile>

          <mat-grid-tile>
            <mat-form-field>
              <mat-label>Valor</mat-label>
              <input
                matInput
                required
                formControlName="valor"
                currencyMask
                maxlength="15"
                [options]="{prefix: 'R$ ', thousands: '.', decimal: ','}"
              />
            </mat-form-field>
          </mat-grid-tile>

          <mat-grid-tile>
            <mat-form-field class="input-medio">
              <mat-label>Data da venda</mat-label>
              <input matInput [matDatepicker]="picker" required id="dataVenda" formControlName="dataVenda" readonly/>
              <mat-datepicker-toggle matIconSuffix [for]="picker"></mat-datepicker-toggle>
              <mat-datepicker #picker></mat-datepicker>
            </mat-form-field>
          </mat-grid-tile>

          <mat-grid-tile>
            <mat-form-field>
              <mat-label>Descrição</mat-label>
              <textarea matInput required formControlName="descricao" maxlength="100"></textarea>
            </mat-form-field>
          </mat-grid-tile>

        </mat-grid-list>

        <mat-card-actions align="start">
          <button matButton type="button" [routerLink]="['/vendas']">cancelar</button>
          <button matButton type="button" (click)="onClearForm()">limpar</button>
          <button matButton type="submit">{{isEditMode ? 'Atualizar' : 'Confirmar'}}</button>
        </mat-card-actions>

      </form>

    </mat-card-content>
</mat-card>

<mat-form-field class="input-filtragem">
  <mat-label>Filtrar</mat-label>
  <input matInput (keyup)="applyFilter($event)" #input>
</mat-form-field>

<table mat-table [dataSource]="vendasList" class="mat-elevation-z8">
  <ng-container matColumnDef="id">
    <th mat-header-cell *matHeaderCellDef>ID</th>
    <td mat-cell *matCellDef="let venda">{{venda.id}}</td>
  </ng-container>

  <ng-container matColumnDef="cliente">
    <th mat-header-cell *matHeaderCellDef>Cliente</th>
    <td mat-cell *matCellDef="let venda">{{venda.cliente}}</td>
  </ng-container>

  <ng-container matColumnDef="valor">
    <th mat-header-cell *matHeaderCellDef>Valor</th>
    <td mat-cell *matCellDef="let venda">{{venda.valor | currency: 'BRL' }}</td>
  </ng-container>

  <ng-container matColumnDef="descricao">
    <th mat-header-cell *matHeaderCellDef>Descrição</th>
    <td mat-cell *matCellDef="let venda">{{venda.descricao}}</td>
  </ng-container>

  <ng-container matColumnDef="dataVenda">
    <th mat-header-cell *matHeaderCellDef>Data da venda</th>
    <td mat-cell *matCellDef="let venda">{{venda.dataVenda | date: 'dd/MM/yyyy' }}</td>
  </ng-container>

  <ng-container matColumnDef="actions">
    <th mat-header-cell *matHeaderCellDef>Ações</th>
    <td mat-cell *matCellDef="let row">
      <button mat-stroked-button [routerLink]="['/vendas', row.id]" (click)="onEdit(row.id)">
        Editar
      </button>
      <button mat-stroked-button [routerLink]="['/vendas', row.id]" (click)="onDelete(row.id)">
        Excluir
      </button>
    </td>
  </ng-container>

  <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
  <tr mat-row *matRowDef="let row; columns: displayedColumns;"></tr>

  <tr class="mat-row" *matNoDataRow>
    <td class="mat-cell" colspan="4">Nenhum dado correspondente ao filtro</td>
  </tr>
</table>
